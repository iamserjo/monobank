[www]
user = sail
group = sail
listen = /var/run/php/php-fpm.sock
listen.owner = www-data
listen.group = www-data
listen.mode = 0660

; Process management settings
pm = dynamic

; Maximum number of child processes (INCREASE THIS)
; Default is often 5, which causes deadlocks with blocking HTTP calls
pm.max_children = 50

; Number of child processes created on startup
pm.start_servers = 10

; Desired minimum number of idle processes
pm.min_spare_servers = 5

; Desired maximum number of idle processes
pm.max_spare_servers = 20

; Maximum number of requests each child should execute before respawning
; This helps prevent memory leaks
pm.max_requests = 500

; Enable status page (optional, for monitoring)
pm.status_path = /fpm-status

; Timeout for serving a single request
; Set this higher than your browserless timeout (120s)
request_terminate_timeout = 180

; Catch worker output
catch_workers_output = yes

; Clear environment variables
clear_env = no

